(()=>{"use strict";const s=window.ReactJSXRuntime,{__}=wp.i18n,{PluginSidebar:e,PluginSidebarMoreMenuItem:t}=wp.editor,{PanelBody:i}=wp.components,{Component:n,Fragment:a}=wp.element,{withSelect:o,withDispatch:h}=wp.data,{compose:l}=wp.compose,{registerPlugin:r}=wp.plugins,p=(0,wp.element.createElement)("img",{width:20,height:20,src:pluginOptions.logo,class:"wpdc-logo"}),d="components-button is-button is-default is-primary is-large wpdc-button",c="components-button is-button is-default is-primary is-large wpdc-button active",u=(0,s.jsxs)("svg",{className:"components-panel__arrow",width:"24px",height:"24px",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",role:"img","aria-hidden":"true",focusable:"false",children:[(0,s.jsx)("g",{children:(0,s.jsx)("path",{fill:"none",d:"M0,0h24v24H0V0z"})}),(0,s.jsx)("g",{children:(0,s.jsx)("path",{d:"M7.41,8.59L12,13.17l4.59-4.58L18,10l-6,6l-6-6L7.41,8.59z"})})]}),g=(0,s.jsxs)("svg",{className:"components-panel__arrow",width:"24px",height:"24px",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",role:"img","aria-hidden":"true",focusable:"false",children:[(0,s.jsx)("g",{children:(0,s.jsx)("path",{fill:"none",d:"M0,0h24v24H0V0z"})}),(0,s.jsx)("g",{children:(0,s.jsx)("path",{d:"M12,8l-6,6l1.41,1.41L12,10.83l4.59,4.58L18,14L12,8z"})})]}),b=/[\/\?#\[\]@!\$&'\(\)\*\+,;=\.%\\`^\s|\{\}"<>]+/;class m extends n{render(){return(0,s.jsxs)("div",{children:[(0,s.jsx)(w,{forcePublish:this.props.forcePublish,published:this.props.published}),(0,s.jsx)(_,{statusMessage:this.props.statusMessage}),(0,s.jsx)(x,{publishingError:this.props.publishingError}),(0,s.jsx)(C,{discoursePermalink:this.props.discoursePermalink})]})}}class w extends n{render(){return this.props.forcePublish&&!this.props.published?(0,s.jsx)("p",{className:"wpdc-force-publish-message",children:__("The Force Publish option is enabled for your site. All posts published on WordPress will be automatically published to Discourse.","wp-discourse")}):""}}class _ extends n{render(){const e=this.props.statusMessage;return e?(0,s.jsx)("div",{className:"wpdc-publishing-response success",children:e}):""}}class x extends n{render(){const e=this.props.publishingError;if(e){let t;switch(e){case"deleted_topic":t=__("Your post could not be published to Discourse. The associated Discourse topic may have been deleted. Unlink the post so that it can be published again.","wp-discourse");break;case"Not Found":t=__("Your post could not be updated on Discourse. The associated Discourse topic may have been deleted. Unlink the post so that it can be published again.","wp-discourse");break;case"queued_topic":t=__("Your post has been added to the Discourse approval queue. When it has been approved, you will need to link it to Discourse byselecting the 'Link to Existing Topic' option.","wp-discourse");break;case"Unprocessable Entity":t=__("Your post could not be published to Discourse. There may be an existing Discourse topic that is using its permalink. Try linking the post with that topic.","wp-discourse");break;case"Forbidden":t=__("Your post could not be published to Discourse. Check that your Discourse Username is set correctly on your WordPress profile page.","wp-discourse");break;default:t=e}return(0,s.jsx)("div",{className:"wpdc-publishing-response error",children:t})}return""}}class C extends n{render(){if(this.props.discoursePermalink){const e=encodeURI(this.props.discoursePermalink),t=(0,s.jsx)("a",{href:e,className:"wpdc-permalink-link",target:"_blank",rel:"noreferrer noopener",children:e});return(0,s.jsxs)("div",{className:"wpdc-permalink",children:[__("Your post is linked with","wp-discourse")," ",t]})}return""}}class P extends n{constructor(s){super(s),this.handleChange=this.handleChange.bind(this)}handleChange(s){this.props.handlePublishMethodChange(s.target.value)}render(){return(0,s.jsxs)("div",{className:"wpdc-publishing-options",children:[(0,s.jsx)("h2",{className:"wpdc-sidebar-title",children:__("Publishing Options","wp-discourse")}),(0,s.jsxs)("label",{htmlFor:"wpdc_publish_option_new_topic",children:[(0,s.jsx)("input",{id:"wpdc_publish_option_new_topic",type:"radio",name:"wpdc_publish_options",value:"publish_post",checked:"publish_post"===this.props.publishingMethod,onChange:this.handleChange}),__("New Topic","wp-discourse")]}),(0,s.jsx)("br",{}),(0,s.jsxs)("label",{htmlFor:"wpdc_publish_option_existing_topic",children:[(0,s.jsx)("input",{id:"wpdc_publish_option_existing_topic",type:"radio",name:"wpdc_publish_options",value:"link_post",checked:"link_post"===this.props.publishingMethod,onChange:this.handleChange}),__("Link to Existing Topic","wp-discourse")]}),(0,s.jsx)("hr",{className:"wpdc-sidebar-hr"})]})}}class k extends n{constructor(s){super(s),this.handleToBePublishedChange=this.handleToBePublishedChange.bind(this),this.handlePublishChange=this.handlePublishChange.bind(this)}handleToBePublishedChange(s){this.props.handleToBePublishedChange(s.target.checked)}handlePublishChange(s){this.props.handlePublishChange(s)}render(){const e=this.props.publishToDiscourse;return"publish"===this.props.postStatus?(0,s.jsxs)("div",{className:"wpdc-component-panel-body",children:[(0,s.jsx)("h2",{className:"wpdc-sidebar-title",children:__("Publish to Discourse","wp-discourse")}),(0,s.jsx)("button",{className:this.props.busy?c:d,onClick:this.handlePublishChange,children:__("Publish to Discourse","wp-discourse")})]}):(0,s.jsxs)("div",{className:"wpdc-component-panel-body",children:[(0,s.jsx)("h2",{className:"wpdc-sidebar-title",children:__("Publish to Discourse","wp-discourse")}),(0,s.jsxs)("div",{className:"wpdc-publish-topic",children:[(0,s.jsx)("input",{type:"checkBox",className:"wpdc-publish-topic-checkbox",checked:e,onChange:this.handleToBePublishedChange}),__("Publish","wp-discourse"),(0,s.jsx)("p",{className:"wpdc-info",children:__("Automatically publish the post to Discourse when it is published on WordPress.","wp-discourse")})]})]})}}class y extends n{constructor(s){super(s),this.handleChange=this.handleChange.bind(this)}handleChange(s){this.props.handleCategoryChange(s.target.value)}render(){if(this.props.discourseCategories){const e=Object.values(this.props.discourseCategories).map(((e,t)=>(0,s.jsx)("option",{value:e.id,selected:parseInt(this.props.category_id,10)===parseInt(e.id,10),children:e.name},t)));return(0,s.jsxs)("div",{className:"wpdc-category-select wpdc-component-panel-body",children:[(0,s.jsx)("h2",{className:"wpdc-sidebar-title",children:__("Category","wp-discourse")}),(0,s.jsx)("select",{onChange:this.handleChange,className:"widefat",children:e}),(0,s.jsx)("hr",{className:"wpdc-sidebar-hr"})]})}return this.props.categoryError?(0,s.jsx)("div",{className:"wpdc-api-error error",children:__("There was an error returning the category list from Discourse.","discourse-integration")}):null}}class T extends n{constructor(s){super(s),this.state={isBusy:!1,topicUrl:null},this.handleChange=this.handleChange.bind(this),this.handleClick=this.handleClick.bind(this)}handleChange(s){this.setState({topicUrl:s.target.value})}handleClick(){this.props.handleLinkTopicClick(this.state.topicUrl)}render(){return(0,s.jsxs)("div",{className:"wpdc-link-post wpdc-component-panel-body",children:[(0,s.jsx)("h2",{className:"wpdc-sidebar-title",children:__("Topic URL","wp-discourse")}),(0,s.jsx)("input",{type:"url",className:"widefat wpdc-topic-url-input",onChange:this.handleChange,value:this.state.topicUrl}),(0,s.jsx)("button",{className:this.props.busy?c:d,onClick:this.handleClick,children:__("Link With Discourse","wp-discourse")})]})}}class j extends n{constructor(s){super(s),this.state={showPanel:!1},this.handleClick=this.handleClick.bind(this),this.togglePanel=this.togglePanel.bind(this)}handleClick(s){this.props.handleUnlinkFromDiscourseChange(s)}togglePanel(){this.setState({showPanel:!this.state.showPanel})}render(){return(0,s.jsxs)("div",{className:"wpdc-component-panel-body",children:[(0,s.jsx)("h2",{className:"wpdc-panel-section-title",children:(0,s.jsxs)("button",{type:"button","aria-expanded":"false",className:"components-button components-panel__body-toggle",onClick:this.togglePanel,children:[(0,s.jsx)("span",{"aria-hidden":"true",children:this.state.showPanel?g:u}),__("Unlink From Discourse","wp-discourse")]})}),(0,s.jsxs)("div",{className:this.state.showPanel?"":"hidden",children:[(0,s.jsx)("p",{className:"wpdc-info",children:__("Unlinking the post from Discourse will remove all Discourse metadata from the post.","wp-discourse")}),(0,s.jsx)("button",{className:this.props.busy?c:d,onClick:this.handleClick,children:__("Unlink Post","wp-discourse")})]})]})}}class f extends n{constructor(s){super(s),this.state={showPanel:!1},this.handleClick=this.handleClick.bind(this),this.togglePanel=this.togglePanel.bind(this)}togglePanel(){this.setState({showPanel:!this.state.showPanel})}handleClick(s){this.props.handleUpdateChange(s)}render(){return(0,s.jsxs)("div",{className:"wpdc-component-panel-body",children:[(0,s.jsx)("h2",{className:"wpdc-panel-section-title",children:(0,s.jsxs)("button",{type:"button","aria-expanded":"false",className:"components-button components-panel__body-toggle",onClick:this.togglePanel,children:[(0,s.jsx)("span",{"aria-hidden":"true",children:this.state.showPanel?g:u}),__("Update Discourse Topic","wp-discourse")]})}),(0,s.jsxs)("div",{className:this.state.showPanel?"":"hidden",children:[(0,s.jsx)("p",{className:"wpdc-info",children:__("Update the Discourse topic to the lastest saved version of the post.","wp-discourse")}),(0,s.jsx)("button",{className:this.props.busy?c:d,onClick:this.handleClick,children:__("Update Topic","wp-discourse")})]})]})}}class v extends n{constructor(s){super(s),this.state={chosenTags:this.props.tags,inputContent:"",inputLength:1,maxTagsExceeded:!1},this.handleKeyPress=this.handleKeyPress.bind(this),this.handleChange=this.handleChange.bind(this),this.handleClick=this.handleClick.bind(this),this.focusInput=this.focusInput.bind(this),this.keyDown=this.keyDown.bind(this)}focusInput(){this.tagInput.focus()}keyDown(s){13===s.keyCode&&this.tagInput.focus()}handleChange(s){const e=s.target.value;this.setState({inputContent:","===e?"":e,inputLength:0===e.length?1:e.length})}handleKeyPress(s){const e=s.key;let t=s.target.value;if("Enter"===e||","===e){let s=this.state.chosenTags;if(s.length>=this.props.maxTags)return this.setState({maxTagsExceeded:!0,inputContent:""}),null;t=this.cleanTag(t),t.length?(s.push(t),s=v.sanitizeArray(s),this.setState({chosenTags:s,inputContent:""},(()=>{this.props.handleTagChange(s)}))):this.setState({inputContent:""})}}cleanTag(s){return(s=(s=(s=s.trim()).replace(/ /g,"-")).replace(/(-)\1+/g,"-")).replace(new RegExp(b,"g"),"")}handleClick(s){const e=this.state.chosenTags,t=e.indexOf(s);t>-1&&(e.splice(t,1),this.setState({chosenTags:e,maxTagsExceeded:!1},(()=>{this.props.handleTagChange(e)})))}static sanitizeArray(s){return s.sort().reduce(((s,e)=>{const t=s.length;return 0!==t&&s[t-1]===e||""===e.trim()||s.push(e),s}),[])}render(){if(this.props.allowTags){const e=this.state.maxTagsExceeded?__("You have exceeded the maximum number of allowed tags for your site. Remove a tag to add more.","wp-discourse"):"";let t=v.sanitizeArray(this.state.chosenTags);return t=t.map((e=>(0,s.jsxs)("span",{className:"components-form-token-field__token",children:[(0,s.jsxs)("span",{className:"components-form-token-field__token-text",children:[(0,s.jsx)("span",{className:"screen-reader-text",children:e}),(0,s.jsx)("span",{"aria-hidden":"true",children:e})]}),(0,s.jsx)("button",{type:"button","aria-label":"Remove Tag",className:"components-button components-icon-button components-form-token-field__remove-token",onClick:this.handleClick.bind(this,e),children:(0,s.jsx)("svg",{"aria-hidden":"true",role:"img",focusable:"false",className:"dashicon dashicons-dismiss",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{d:"M10 2c4.42 0 8 3.58 8 8s-3.58 8-8 8-8-3.58-8-8 3.58-8 8-8zm5 11l-3-3 3-3-2-2-3 3-3-3-2 2 3 3-3 3 2 2 3-3 3 3z"})})},e)]},e))),(0,s.jsxs)("div",{className:"wpdc-component-panel-body",children:[(0,s.jsx)("h2",{className:"wpdc-sidebar-title",children:__("Tags","wp-discourse")}),(0,s.jsxs)("div",{className:"components-form-token-field__input-container",onClick:this.focusInput,onKeyDown:this.keyDown,role:"combobox",tabIndex:0,children:[t,(0,s.jsx)("input",{type:"text",size:this.state.inputLength,className:"components-form-token-field__input",onChange:this.handleChange,onKeyPress:this.handleKeyPress,value:this.state.inputContent,ref:s=>{this.tagInput=s}})]}),(0,s.jsx)("div",{className:this.state.maxTagsExceeded?"wpdc-info":"",children:e}),(0,s.jsx)("hr",{className:"wpdc-sidebar-hr"})]})}return null}}class N extends n{constructor(s){super(s),this.state={pinTopic:this.props.pinTopic,pinUntil:this.props.pinUntil},this.handleUpdateDate=this.handleUpdateDate.bind(this),this.handleToBePinnedChange=this.handleToBePinnedChange.bind(this)}handleUpdateDate(s){this.setState({pinUntil:s.target.value}),this.props.handlePinChange(this.state.pinTopic,s.target.value)}handleToBePinnedChange(s){this.setState({pinTopic:s.target.checked}),this.props.handlePinChange(s.target.checked,this.state.pinUntil)}render(){return(0,s.jsxs)("div",{className:"wpdc-component-panel-body",children:[(0,s.jsx)("h2",{className:"wpdc-sidebar-title",children:__("Pin Topic","wp-discourse")}),(0,s.jsxs)("label",{htmlFor:"wpdc-pin-topic",children:[(0,s.jsx)("input",{id:"wpdc-pin-topic",type:"checkbox",onChange:this.handleToBePinnedChange,checked:this.state.pinTopic}),__("Pin Discourse Topic","wp-discourse")]}),(0,s.jsx)("br",{}),(0,s.jsxs)("label",{className:"wpdc-pin-until-input",htmlFor:"wpdc-pin-topic-until",children:[__("Pin Until","wp-discourse"),(0,s.jsx)("br",{}),(0,s.jsx)("input",{id:"wpdc-pin-topic-until",type:"date",className:"widefat",onChange:this.handleUpdateDate,value:this.state.pinUntil})]}),(0,s.jsx)("hr",{className:"wpdc-sidebar-hr"})]})}}r("discourse-sidebar",{icon:p,render:l([o(((s,{})=>{const{getCurrentPostId:e,getCurrentPost:t}=s("core/editor");return{postId:e(),post:t()}})),h((s=>{const{editPost:e}=s("core/editor");return{setAutoPublishOverridden(s){e({meta:{wpdc_auto_publish_overridden:s}})}}}))])(class extends n{constructor(s){super(s),this.initializePostMeta(),this.state=this.initializePostState(this.props.post),this.getDiscourseCategories(),this.handleToBePublishedChange=this.handleToBePublishedChange.bind(this),this.handlePublishChange=this.handlePublishChange.bind(this),this.handleCategoryChange=this.handleCategoryChange.bind(this),this.handleTagChange=this.handleTagChange.bind(this),this.handleUnlinkFromDiscourseChange=this.handleUnlinkFromDiscourseChange.bind(this),this.handlePublishMethodChange=this.handlePublishMethodChange.bind(this),this.handleUpdateChange=this.handleUpdateChange.bind(this),this.handleLinkTopicClick=this.handleLinkTopicClick.bind(this),this.handlePinChange=this.handlePinChange.bind(this)}componentDidUpdate(s){this.isAllowedPostType()&&this.publishedPostHasChanged(s.post,this.props.post)&&this.updatePostState(this.props.post)}publishedPostHasChanged(s,e){return!!(s&&e&&s.meta&&e.meta)&&![e.status,s.status].every((s=>"publish"!==s))&&(e.status!==s.status||["discourse_post_id","wpdc_publishing_response","wpdc_publishing_error"].some((t=>e.meta[t]!==s.meta[t])))}initializePostMeta(){this.isAllowedPostType()&&this.props.post&&"publish"===this.props.post.status&&this.props.setAutoPublishOverridden("1")}initializePostState(s){if(!this.isAllowedPostType())return{};let e={published:!1,postStatus:"",publishingMethod:"publish_post",forcePublish:pluginOptions.forcePublish,publishToDiscourse:pluginOptions.autoPublish,publishPostCategory:pluginOptions.defaultCategory,allowTags:pluginOptions.allowTags,maxTags:pluginOptions.maxTags,topicTags:[],pinTopic:!1,pinUntil:null,discoursePostId:null,discoursePermalink:null,publishingError:null,busyUnlinking:!1,busyUpdating:!1,busyLinking:!1,busyPublishing:!1,statusMessage:null,discourseCategories:null,categoryError:!1};return s&&s.meta&&(e=Object.assign(e,this.buildPostState(s))),e}updatePostState(s){this.setState(this.buildPostState(s))}buildPostState(s){if(!s||!s.meta)return{};const e=s.meta,t="string"==typeof e.wpdc_topic_tags?e.wpdc_topic_tags.split(","):[],i={publishToDiscourse:this.determinePublishToDiscourse(e),published:e.discourse_post_id>0,postStatus:s.status,topicTags:t,pinTopic:e.wpdc_pin_topic>0};return e.publish_post_category>0&&(i.publishPostCategory=e.publish_post_category),e.wpdc_pin_until&&(i.pinUntil=e.wpdc_pin_until),e.discourse_post_id&&(i.discoursePostId=e.discourse_post_id),e.discourse_permalink&&(i.discoursePermalink=e.discourse_permalink),e.wpdc_publishing_error&&(i.publishingError=e.wpdc_publishing_error),i}determinePublishToDiscourse(s){const e=pluginOptions.autoPublish,t=1===parseInt(s.wpdc_auto_publish_overridden,10);let i;return i=!(["deleted_topic","queued_topic"].includes(s.wpdc_publishing_error)||(!e||t)&&1!==parseInt(s.wpdc_publish_to_discourse,10)),i}getDiscourseCategories(){pluginOptions.pluginUnconfigured||wp.apiRequest({path:"/wp-discourse/v1/get-discourse-categories",method:"GET",data:{get_categories_nonce:pluginOptions.get_categories_nonce,id:this.props.postId}}).then((s=>{this.setState({discourseCategories:s})}),(()=>{this.setState({categoryError:!0})}))}isAllowedPostType(){return pluginOptions.allowedPostTypes.indexOf(this.props.post.type)>=0}handlePublishMethodChange(s){this.setState({publishingMethod:s})}handleToBePublishedChange(s){this.setState({publishToDiscourse:s,statusMessage:""},(()=>{wp.apiRequest({path:"/wp-discourse/v1/set-publish-meta",method:"POST",data:{set_publish_meta_nonce:pluginOptions.set_publish_meta_nonce,id:this.props.postId,publish_to_discourse:this.state.publishToDiscourse?1:0}}).then((()=>null),(()=>null))}))}handleCategoryChange(s){this.setState({publishPostCategory:s},(()=>{wp.apiRequest({path:"/wp-discourse/v1/set-category-meta",method:"POST",data:{set_category_meta_nonce:pluginOptions.set_category_meta_nonce,id:this.props.postId,publish_post_category:s}}).then((()=>null),(()=>null))}))}handlePinChange(s,e){this.setState({pinTopic:s,pinUntil:e},(()=>{wp.apiRequest({path:"/wp-discourse/v1/set-pin-meta",method:"Post",data:{set_pin_meta_nonce:pluginOptions.set_pin_meta_nonce,id:this.props.postId,wpdc_pin_topic:s?1:0,wpdc_pin_until:e}}).then((()=>null),(()=>null))}))}handleTagChange(s){this.setState({topicTags:s},(()=>{const e=s.join(",");wp.apiRequest({path:"/wp-discourse/v1/set-tag-meta",method:"POST",data:{set_tag_meta_nonce:pluginOptions.set_tag_meta_nonce,id:this.props.postId,wpdc_topic_tags:e}}).then((()=>null),(()=>null))}))}handleLinkTopicClick(s){this.setState({busyLinking:!0,statusMessage:""}),wp.apiRequest({path:"/wp-discourse/v1/link-topic",method:"POST",data:{link_topic_nonce:pluginOptions.link_topic_nonce,id:this.props.postId,topic_url:s}}).then((s=>(this.setState({busyLinking:!1}),s.discourse_permalink?this.setState({published:!0,discoursePermalink:s.discourse_permalink,publishingError:null}):this.setState({publishingError:__("There has been an error linking your post with Discourse.","wp-discourse")}),null)),(s=>{const e=s.responseJSON&&s.responseJSON.message?s.responseJSON.message:__("There has been an error linking your post with Discourse.","wp-discourse");return this.setState({busyLinking:!1,published:!1,publishingError:e}),null}))}handleUnlinkFromDiscourseChange(){this.setState({busyUnlinking:!0,statusMessage:""}),wp.apiRequest({path:"/wp-discourse/v1/unlink-post",method:"POST",data:{unlink_post_nonce:pluginOptions.unlink_post_nonce,id:this.props.postId}}).then((()=>(this.setState({busyUnlinking:!1,published:!1,publishingMethod:"link_post",discoursePermalink:null,statusMessage:__("Your post has been unlinked from Discourse.","wp-discourse")}),null)),(()=>null))}handlePublishChange(){this.setState({busyPublishing:!0,statusMessage:""}),wp.apiRequest({path:"/wp-discourse/v1/publish-topic",method:"POST",data:{publish_topic_nonce:pluginOptions.publish_topic_nonce,id:this.props.postId}}).then((s=>{const e="success"===s.publish_response;return this.setState({busyPublishing:!1,published:e,publishingError:e?null:s.publish_response,publishingMethod:s.publish_response="link_post",discoursePermalink:s.discourse_permalink}),null}),(s=>{const e=s.responseJSON&&s.responseJSON.message?s.responseJSON.message:__("There has been an error linking your post with Discourse.","wp-discourse");return this.setState({busyPublishing:!1,published:!1,publishingError:e}),null}))}handleUpdateChange(){this.setState({busyUpdating:!0,statusMessage:""}),wp.apiRequest({path:"/wp-discourse/v1/update-topic",method:"POST",data:{update_topic_nonce:pluginOptions.update_topic_nonce,id:this.props.postId}}).then((s=>{const e="success"===s.update_response;let t;return e&&(t=__("The Discourse topic has been updated!","wp-discourse")),this.setState({busyUpdating:!1,statusMessage:t,publishingError:e?null:s.update_response}),null}),(()=>{const s=__("There was an error updating the Discourse topic.","wp-discourse");return this.setState({busyUpdating:!1,statusMessage:s}),null}))}render(){if(this.isAllowedPostType()){const n=this.state.published,o=this.state.forcePublish;let h;return h=pluginOptions.pluginUnconfigured?(0,s.jsx)("div",{className:"wpdc-plugin-unconfigured",children:__("Before you can publish posts from WordPress to Discourse, you need to configure the plugin's Connection Settings tab.","discourse-integration")}):n||o?o?null:(0,s.jsxs)("div",{className:"wpdc-published-post",children:[(0,s.jsx)(f,{published:this.state.published,busy:this.state.busyUpdating,handleUpdateChange:this.handleUpdateChange,forcePublish:this.state.forcePublish}),(0,s.jsx)(j,{published:this.state.published,handleUnlinkFromDiscourseChange:this.handleUnlinkFromDiscourseChange,busy:this.state.busyUnlinking,forcePublish:this.state.forcePublish})]}):(0,s.jsxs)("div",{className:"wpdc-not-published",children:[(0,s.jsx)(P,{handlePublishMethodChange:this.handlePublishMethodChange,publishingMethod:this.state.publishingMethod}),"publish_post"===this.state.publishingMethod?(0,s.jsxs)("div",{className:"wpdc-publish-to-discourse",children:[(0,s.jsx)(y,{category_id:this.state.publishPostCategory,handleCategoryChange:this.handleCategoryChange,discourseCategories:this.state.discourseCategories,categoryError:this.state.categoryError}),(0,s.jsx)(v,{handleTagChange:this.handleTagChange,tags:this.state.topicTags,allowTags:this.state.allowTags,maxTags:this.state.maxTags}),(0,s.jsx)(N,{handlePinChange:this.handlePinChange,pinTopic:this.state.pinTopic,pinUntil:this.state.pinUntil}),(0,s.jsx)(k,{postStatus:this.state.postStatus,publishToDiscourse:this.state.publishToDiscourse,handleToBePublishedChange:this.handleToBePublishedChange,handlePublishChange:this.handlePublishChange,busy:this.state.busyPublishing})]}):(0,s.jsx)("div",{className:"wpdc-link-to-discourse",children:(0,s.jsx)(T,{busy:this.state.busyLinking,handleLinkTopicClick:this.handleLinkTopicClick})})]}),(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{target:"discourse-sidebar",children:__("Discourse","wp-discourse")}),(0,s.jsx)(e,{name:"discourse-sidebar",title:__("Discourse","wp-discourse"),children:(0,s.jsx)(i,{children:(0,s.jsxs)("div",{className:"wpdc-sidebar",children:[(0,s.jsx)(m,{published:this.state.published,forcePublish:this.state.forcePublish,publishingError:this.state.publishingError,discoursePermalink:this.state.discoursePermalink,statusMessage:this.state.statusMessage}),h]})})})]})}return null}})})})();